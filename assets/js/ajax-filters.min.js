jQuery(document).ready(function(t){var a=[];t(".restaurant_listings").on("update_results",function(e,r,s,i){var n,o,l,d,_="",c=t(this),u=c.find(".restaurant_filters"),g=c.find(".showing_restaurants"),p=c.find(".restaurant_listings"),h=c.data("per_page"),f=c.data("orderby"),w=c.data("order"),v=c.data("featured"),m=c.data("restaurant_types"),y=c.data("post_status"),k=t("div.restaurant_listings").index(this);if(!(k<0)){if(a[k]&&a[k].abort(),s||(t(p).addClass("loading"),t("li.restaurant_listings, li.no_restaurant_listings_found",p).css("visibility","hidden"),r>1&&!0!==c.data("show_pagination")?t(p).before('<a class="load_more_restaurants load_previous" href="#"><strong>'+restaurant_listings_ajax_filters.i18n_load_prev_listings+"</strong></a>"):c.find(".load_previous").remove(),c.find(".load_more_restaurants").data("page",r)),!0===c.data("show_filters")){var x=[];t(':input[name="filter_restaurant_type[]"]:checked, :input[name="filter_restaurant_type[]"][type="hidden"], :input[name="filter_restaurant_type"]',u).each(function(){x.push(t(this).val())}),n=u.find(':input[name^="search_categories"]').map(function(){return t(this).val()}).get(),o="",l="",d=u.find(':input[name="search_price_range"]').val();var b=u.find(':input[name="search_keywords"]'),j=u.find(':input[name="search_location"]');b.val()!==b.attr("placeholder")&&(o=b.val()),j.val()!==j.attr("placeholder")&&(l=j.val()),_={lang:restaurant_listings_ajax_filters.lang,search_keywords:o,search_location:l,search_categories:n,filter_restaurant_type:x,search_price_range:d,filter_post_status:y,per_page:h,orderby:f,order:w,page:r,featured:v,show_pagination:c.data("show_pagination"),form_data:u.serialize()}}else n=c.data("categories"),o=c.data("keywords"),l=c.data("location"),d=c.data("price_range"),n&&(n=n.split(",")),_={lang:restaurant_listings_ajax_filters.lang,search_categories:n,search_keywords:o,search_location:l,filter_post_status:y,search_price_range:d,filter_restaurant_type:m,per_page:h,orderby:f,order:w,page:r,featured:v,show_pagination:c.data("show_pagination")};a[k]=t.ajax({type:"POST",url:restaurant_listings_ajax_filters.ajax_url.toString().replace("%%endpoint%%","get_listings"),data:_,success:function(a){if(a)try{a.showing?t(g).show().html("<span>"+a.showing+"</span>"+a.showing_links):t(g).hide(),a.showing_all?t(g).addClass("wp-restaurant-listings-showing-all"):t(g).removeClass("wp-restaurant-listings-showing-all"),a.html&&(s&&i?t(p).prepend(a.html):s?t(p).append(a.html):t(p).html(a.html)),!0===c.data("show_pagination")?(c.find(".restaurant-listings-pagination").remove(),a.pagination&&c.append(a.pagination)):(!a.found_restaurants||a.max_num_pages<=r?t(".load_more_restaurants:not(.load_previous)",c).hide():i||t(".load_more_restaurants",c).show(),t(".load_more_restaurants",c).removeClass("loading"),t("li.restaurant_listings",p).css("visibility","visible")),t(p).removeClass("loading"),c.triggerHandler("updated_results",a)}catch(t){window.console&&window.console.log(t)}},error:function(t,a,e){window.console&&"abort"!==a&&window.console.log(a+": "+e)},statusCode:{404:function(){window.console&&window.console.log("Error 404: Ajax Endpoint cannot be reached. Go to Settings > Permalinks and save to resolve.")}}})}}),t('#search_keywords, #search_location, .restaurant_types :input, #search_categories, .restaurant-listings-filter, input[name="search_price_range"]').change(function(){var a=t(this).closest("div.restaurant_listings");a.triggerHandler("update_results",[1,!1]),s(a,1)}).on("keyup",function(a){13===a.which&&t(this).trigger("change")}),t(".restaurant_filters").on("click",".reset",function(){var a=t(this).closest("div.restaurant_listings"),e=t(this).closest("form");return e.find(':input[name="search_keywords"], :input[name="search_location"], .restaurant-listings-filter').not(':input[type="hidden"]').val("").trigger("change"),e.find(':input[name^="search_categories"]').not(':input[type="hidden"]').val("").trigger("change"),t(':input[name="filter_restaurant_type[]"]',e).not(':input[type="hidden"]').attr("checked","checked"),e.find(':input[name="search_price_range"]').val(""),e.find(".price_range_filter li").attr("style",""),a.triggerHandler("reset"),a.triggerHandler("update_results",[1,!1]),s(a,1),!1}),t(document.body).on("click",".load_more_restaurants",function(){var a=t(this).closest("div.restaurant_listings"),e=parseInt(t(this).data("page")||1,10),r=!1;return t(this).addClass("loading"),t(this).is(".load_previous")?(r=!0,1===(e-=1)?t(this).remove():t(this).data("page",e)):(e+=1,t(this).data("page",e),s(a,e)),a.triggerHandler("update_results",[e,!0,r]),!1}),t(".price_range_filter").on("click","li",function(){t(".price_range_filter li").attr("style","");var a=t(this);t('input[name="search_price_range"]').attr("value",a.attr("data-price_range")),t('input[name="search_price_range"]').triggerHandler("change"),a.css({"background-color":"#c4f3a4",border:"1px solid #41a700",color:"#348c42"})}),t("div.restaurant_listings").on("click",".restaurant-listings-pagination a",function(){var a=t(this).closest("div.restaurant_listings"),e=t(this).data("page");return s(a,e),a.triggerHandler("update_results",[e,!1]),t("body, html").animate({scrollTop:a.offset().top},600),!1}),t.isFunction(t.fn.select2)&&(1===restaurant_listings_ajax_filters.is_rtl&&t('select[name^="search_categories"]').addClass("select2-rtl"),t('select[name^="search_categories"]').select2());var e=!1;window.history&&window.history.pushState&&(e=!0);var r=document.location.href.split("#")[0];function s(a,s){if(e){var i=a.find(".restaurant_filters"),n=t(i).serialize(),o=t("div.restaurant_listings").index(a);window.history.replaceState({id:"restaurant_listings_state",page:s,data:n,index:o},"",r+"#s=1")}}t(window).on("load",function(){t(".restaurant_filters").each(function(){var a=t(this).closest("div.restaurant_listings"),e=a.find(".restaurant_filters"),r=1,s=t("div.restaurant_listings").index(a);if(window.history.state&&window.location.hash){var i=window.history.state;i.id&&"restaurant_listings_state"===i.id&&s===i.index&&(r=i.page,e.deserialize(i.data),e.find(':input[name^="search_categories"]').not(':input[type="hidden"]').trigger("change"))}a.triggerHandler("update_results",[r,!1])})})});